<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atividade de Ciências - Recuperação 8º Ano</title>
    <style>
        /* Reset e configurações gerais */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        body {
            background-color: #d0d0d0;
            padding: 20px;
            min-height: 100vh;
            background-image: linear-gradient(145deg, #c0c0c0, #e0e0e0);
        }
        
        /* Container principal */
        .container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background-color: #d0d0d0;
            z-index: 1;
            border-radius: 20px;
            box-shadow: inset 5px 5px 10px #b3b3b3, 
                       inset -5px -5px 10px #ededed;
        }
        
        /* Cabeçalho */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(145deg, #e6f2ff, #cce5ff);
            border-radius: 12px;
            box-shadow: 8px 8px 16px #b3b3b3, 
                       -8px -8px 16px #ffffff;
            position: relative;
            z-index: 2;
            border: 1px solid #b8d4f0;
        }
        
        .school-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #004085;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        /* Informações do aluno - Layout responsivo */
        .student-info {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
        }
        
        @media (max-width: 768px) {
            .student-info {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
        
        .info-group {
            display: flex;
            align-items: center;
        }
        
        .name-group {
            grid-column: 1 / 2;
        }
        
        @media (max-width: 768px) {
            .name-group {
                grid-column: 1 / 2;
            }
        }
        
        .info-label {
            margin-right: 5px;
            font-weight: bold;
            color: #004085;
            white-space: nowrap;
        }
        
        .info-field {
            padding: 8px;
            border: 1px solid #a0c4e0;
            border-radius: 4px;
            background-color: #f8fbff;
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.1);
            text-align: center;
            width: 100%;
        }
        
        .activity-title {
            font-size: 20px;
            font-weight: bold;
            margin: 20px 0;
            text-align: center;
            color: #004085;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        /* Questões */
        .question-container {
            padding: 25px;
            margin-bottom: 30px;
            background: linear-gradient(145deg, #e6f2ff, #cce5ff);
            border-radius: 12px;
            box-shadow: 8px 8px 16px #b3b3b3, 
                       -8px -8px 16px #ffffff;
            position: relative;
            z-index: 2;
            border: 1px solid #b8d4f0;
        }
        
        .question {
            margin-bottom: 15px;
            font-weight: bold;
            color: #004085;
            line-height: 1.4;
        }
        
        .question-image {
            max-width: 100%;
            height: auto;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 4px 4px 8px rgba(0,0,0,0.2);
            border: 1px solid #a0c4e0;
            display: block;
        }
        
        .options {
            margin-top: 15px;
        }
        
        .option {
            margin-bottom: 10px;
            padding: 12px;
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            border-radius: 8px;
            border: 1px solid #d0d0d0;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 4px 4px 8px rgba(0,0,0,0.1),
                       -4px -4px 8px rgba(255,255,255,0.7);
            display: flex;
            align-items: flex-start;
        }
        
        .option:hover {
            background: linear-gradient(145deg, #f5f5f5, #e8e8e8);
            transform: translateY(-2px);
            box-shadow: 6px 6px 12px rgba(0,0,0,0.15),
                       -6px -6px 12px rgba(255,255,255,0.8);
        }
        
        .option.selected {
            background: linear-gradient(145deg, #155724, #0f4019);
            border-color: #0f4019;
            color: white;
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.3),
                        4px 4px 8px rgba(0,0,0,0.1);
        }
        
        /* Letras das alternativas - apenas via pseudo-elemento */
        .option::before {
            content: attr(data-letter) ".";
            font-weight: bold;
            margin-right: 8px;
            flex-shrink: 0;
        }
        
        /* Botões */
        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            position: relative;
            z-index: 2;
            gap: 15px;
        }
        
        @media (max-width: 480px) {
            .buttons {
                flex-direction: column;
            }
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 6px 6px 12px rgba(0,0/0,0.2),
                       -6px -6px 12px rgba(255,255,255,0.7);
            flex: 1;
        }
        
        #submitBtn {
            background: linear-gradient(145deg, #007bff, #0056b3);
            color: white;
        }
        
        #submitBtn:hover {
            background: linear-gradient(145deg, #0056b3, #004085);
            transform: translateY(-2px);
            box-shadow: 8px 8px 16px rgba(0,0,0,0.25),
                       -8px -8px 16px rgba(255,255,255,0.7);
        }
        
        #submitBtn:active {
            transform: translateY(1px);
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        #clearBtn {
            background: linear-gradient(145deg, #6c757d, #545b62);
            color: white;
        }
        
        #clearBtn:hover {
            background: linear-gradient(145deg, #545b62, #3d4348);
            transform: translateY(-2px);
            box-shadow: 8px 8px 16px rgba(0,0,0,0.25),
                       -8px -8px 16px rgba(255,255,255,0.7);
        }
        
        #clearBtn:active {
            transform: translateY(1px);
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        /* Resultado */
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
            box-shadow: 4px 4px 8px rgba(0,0,0,0.1);
            position: relative;
            z-index: 2;
        }
        
        .success {
            background: linear-gradient(145deg, #d4edda, #c3e6cb);
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .error {
            background: linear-gradient(145deg, #f8d7da, #f5c6cb);
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="school-name">E.E. PROFª WANDA MASCAGNI DE SÁ</div>
            <div class="student-info">
                <div class="info-group name-group">
                    <span class="info-label">NOME:</span>
                    <select id="studentName" class="info-field">
                        <option value="">Selecione seu nome</option>
                        <!-- Opções serão preenchidas via JavaScript -->
                    </select>
                </div>
                <div class="info-group">
                    <span class="info-label">Nº:</span>
                    <input type="text" id="studentNumber" class="info-field" readonly>
                </div>
                <div class="info-group">
                    <span class="info-label">SÉRIE:</span>
                    <input type="text" id="studentGrade" class="info-field" readonly>
                </div>
                <div class="info-group">
                    <span class="info-label">DATA:</span>
                    <input type="text" id="currentDate" class="info-field" value="" readonly>
                </div>
            </div>
            <div class="activity-title">ATIVIDADE DE CIÊNCIAS (RECUPERAÇÃO 8º ANO)</div>
        </div>
        
        <div id="questionsContainer">
            <!-- As questões serão inseridas aqui via JavaScript -->
        </div>
        
        <div class="buttons">
            <button id="submitBtn">Enviar Respostas</button>
            <button id="clearBtn">Limpar Respostas</button>
        </div>
        
        <div id="resultMessage" class="result"></div>
    </div>

    <script>
        /* ============================================================
           CONFIGURAÇÕES GERAIS
           ============================================================ */
        // Mantenha a URL original. A correção de CORS está no Apps Script.
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx7Nnm9OrWIVGCtBda0-VI5ukgep2iee5ZTKGl923PpV2ACnY_jGccFR9iX1s0Yy-w/exec";

        /* ============================================================
           LISTA COMPLETA DE ALUNOS
           ============================================================ */

        const students = {
            "8º Ano A": [
                { number: "2", name: "ANA BEATRIZ RODRIGUES OLIVEIRA" },
                { number: "3", name: "ANA CLARA SOUSA DA COSTA" },
                { number: "4", name: "ANA VICTORIA RAGACINI DE OLIVEIRA" },
                { number: "5", name: "ARTHUR DAVI DE SOUZA FERNANDES" },
                { number: "6", name: "EDUARDA ALVES DE SOUZA" },
                { number: "7", name: "EMANUEL ALVES OLIVEIRA" },
                { number: "8", name: "ESTHER CRISTINE SILVA RIBEIRO" },
                { number: "9", name: "EVELLYN YASMIN TAVARES SILVA" },
                { number: "10", name: "FELIPE DE SOUZA RODRIGUES" },
                { number: "11", name: "FERNANDA POLACHINI MAYER GOMES MARQUES" },
                { number: "12", name: "GEOVANNA VITORIA ROCHA ABDALA" },
                { number: "15", name: "GUSTAVO AUGUSTO TOMBOLO REIS" },
                { number: "17", name: "IGOR MARTINS PEREIRA" },
                { number: "18", name: "IZABELLY VITORIA DE CARVALHO RODRIGUES SETH" },
                { number: "21", "name": "KAROLAYNE DOS SANTOS BISSORNIA" },
                { number: "22", name: "KAUANNY APARECIDA MALAQUIAS LIMA" },
                { number: "23", name: "KÉTHILY NAYARA DA SILVA" },
                { number: "25", name: "LAVINIA PEREIRA DE SOUZA" },
                { number: "26", name: "LIVIA PEREIRA DE SOUZA" },
                { number: "27", name: "LOHRAN ROMUALDO MENDES DA SILVA" },
                { number: "28", name: "LUIS MIGUEL GONCALVES DA SILVA" },
                { number: "29", name: "MARCELA ROBERTO DE OLIVEIRA" },
                { number: "31", name: "MATHEUS TURCHETTO" },
                { number: "32", name: "OMRAN RASEKH" },
                { number: "33", name: "PRISCILLA VITORIA MENDES DE OLIVEIRA" },
                { number: "36", name: "SARAH VITORIA ALVES OLIVEIRA" },
                { number: "37", name: "YURI GABRIEL DE MORAES PONGOLINO" },
                { number: "38", name: "ZAYN AL ABIDIN RASULI" },
                { number: "39", name: "ARTHUR COHEN BARRETO" },
                { number: "40", name: "ISABELLA DOS SANTOS SALDANHA" },
                { number: "41", name: "MIGUEL MARTINS DE ASSIS" },
                { number: "42", name: "ALICE CARVALHO" },
                { number: "43", name: "AMANDA PASSOS DE ALMEIDA" },
                { number: "44", name: "ANA JULIA MENEZES DA SILVA" },
                { number: "45", name: "HENRIQUE ROCHA CARVALHAL" }
            ],
            "8º Ano B": [
                { number: "2", name: "ANA CLARA GONCALVES TORRES LOYOLA" },
                { number: "3", name: "ANNA BEATRIZ SANTIAGO DA SILVA" },
                { number: "6", name: "ELIAS SILVA DE LIMA" },
                { number: "7", name: "EVERTON HENRIQUE CARMO RODRIGUES" },
                { number: "9", name: "GABRIELA VITORIA SEVERA LINS" },
                { number: "12", name: "JULIO CESAR ALVES DOS SANTOS" },
                { number: "14", name: "LUAN VENITES BALBINO" },
                { number: "17", name: "MARIA EDUARDA FELIX DA SILVA" },
                { number: "18", name: "MONIQUE RIJO COSTA" },
                { number: "19", name: "MUNIQUE CRISTINA LUCAS" },
                { number: "20", name: "NICOLAS PENTEADO" },
                { number: "23", name: "PAULO CELSO DA COSTA JUNIOR" },
                { number: "24", name: "PEDRO HENRIQUE CARLOS LIMA" },
                { number: "25", name: "PEDRO HENRIQUE MORAIS AMORIM" },
                { number: "27", name: "PIETRO RODRIGUES MIRANDA" },
                { number: "28", name: "RAPHAELLY APARECIDA MARINHO DE OLIVEIRA" },
                { number: "29", name: "RENAN LEANDRO RODRIGUES VICENTE" },
                { number: "33", name: "WENDELL RAFAEL DE JESUS LESSA" },
                { number: "34", name: "WILHAN KENJI ANTONIO" },
                { number: "40", name: "JENNYFER VITORIA BASILIO GOMES" },
                { number: "41", name: "THAYNA SEABRA DE OLIVEIRA DO NASCIMENTO" },
                { number: "46", name: "SOPHIA MENEZES DE ARAUJO" },
                { number: "47", name: "VITORIA MENEZES BRANDAO" },
                { number: "49", name: "LORENA ALEXANDRE SANTOS DA SILVA" },
                { number: "50", name: "MANUELLA DE MORAES SOUZA" },
                { number: "51", name: "VITORIA JOLIE RODRIGUES RAPOSO" },
                { number: "52", name: "RAQUEL BARGAS TAVARES DOS SANTOS" },
                { number: "53", name: "RODOLFO RAFAEL GOLZENLEUCHTER MORENO JUNIOR" },
                { number: "54", name: "ANTONIO CARLOS CAMPOS NETO" }
            ]
        };

        /* ============================================================
           QUESTÕES DO TESTE
           ============================================================ */

        const questions = [
            {
                id: 1,
                question: "Durante uma aula de Ciências, os alunos realizaram um experimento para identificar diferentes formas de energia. Eles observaram que ao ligar um ventilador, a energia elétrica era convertida em energia mecânica (movimento das pás) e energia sonora (ruído do motor). Além disso, após algum tempo de funcionamento, notaram que o motor do ventilador estava aquecido. Considerando os diferentes tipos de energia estudados, qual alternativa descreve corretamente as transformações de energia que ocorrem nesse aparelho?",
                image: "",
                options: [
                    { text: "A energia elétrica é transformada apenas em energia mecânica, sendo o ruído e o calor considerados perdas energéticas indesejadas.", correct: false },
                    { text: "A energia elétrica se transforma em energia mecânica, sonora e térmica, demonstrando o princípio da conservação da energia, donde a energia total se mantém, apenas mudando de forma.", correct: true },
                    { text: "O calor gerado pelo motor representa uma criação de energia térmica que não existia anteriormente no sistema, contrariando o princípio de conservação.", correct: false },
                    { text: "A energia sonora produzida pelo ventilador é uma forma primária de energia que não deriva da energia elétrica fornecida ao aparelho.", correct: false }
                ]
            },
            {
                id: 2,
                question: "O Brasil possui uma matriz energética diversificada, com significativa participação de fontes renováveis. Em 2023, cerca de 48% da energia consumida no país veio de fontes renováveis, enquanto a média mundial é de aproximadamente 14%. Considerando as características das fontes de energia renováveis e não renováveis, qual alternativa apresenta corretamente uma vantagem das fontes renováveis em relação às não renováveis?",
                image: "https://via.placeholder.com/800x300?text=Matriz+Energética+Brasileira",
                options: [
                    { text: "As fontes renováveis apresentam custos de instalação sempre inferiores aos das fontes não renováveis, tornando-as mais acessíveis economicamente.", correct: false },
                    { text: "As fontes renováveis são inesgotáveis em escala humana e causam menor impacto ambiental, contribuindo para a sustentabilidade e reduzindo as emissões de gases de efeito estufa.", correct: true },
                    { text: "As fontes renováveis não dependem de condições climáticas para seu funcionamento, garantindo produção constante e previsível de energia.", correct: false },
                    { text: "As fontes renováveis não exigem grandes áreas para instalação, sendo mais adequadas para regiões urbanas densamente povoadas.", correct: false }
                ]
            },
            {
                id: 3,
                question: "Em uma montanha-russa, os carrinhos são puxados até o ponto mais alto por um mecanismo motorizado. Ao serem soltos, descem rapidamente, subindo novamente em seguida, sem necessidade de motor durante a maior parte do percurso. Considerando o princípio da conservação da energia, qual alternativa explica corretamente o funcionamento da montanha-russa?",
                image: "https://via.placeholder.com/800x400?text=Montanha+Russa",
                options: [
                    { text: "A energia potencial gravitacional acumulada no ponto mais alto é convertida em energia cinética durante a descida, e parte dessa energia cinética é novamente convertida em energia potencial nas subidas subsequentes.", correct: true },
                    { text: "A energia cinética permanece constante durante todo o percurso, pois a velocidade dos carrinhos não varia significativamente.", correct: false },
                    { text: "A energia total do sistema aumenta durante as descidas e diminui durante as subidas, demonstrando que a energia pode ser criada e destruída.", correct: false },
                    { text: "A energia potencial é máxima nos pontos mais baixos do percurso e mínima nos pontos mais altos, permitindo o movimento contínuo dos carrinhos.", correct: false }
                ]
            },
            {
                id: 4,
                question: "O Objetivo de Desenvolvimento Sustentável (ODS) 7 da ONU visa 'garantir o acesso a fontes de energia acessíveis, confiáveis, sustentáveis e modernas para todos' até 2030. No Brasil, aproximadamente 2 milhões de pessoas ainda não têm acesso à energia elétrica, especialmente em comunidades remotas. Considerando esse contexto, qual alternativa apresenta corretamente um desafio para a implementação de energias renováveis nessas regiões?",
                image: "",
                options: [
                    { text: "As energias renováveis são tecnicamente inviáveis em áreas remotas devido à falta de vento ou radiação solar nessas regiões.", correct: false },
                    { text: "O alto custo inicial de instalação, a falta de mão de obra especializada e as dificuldades de acesso a algumas localidades são obstáculos para a implementação de energias renováveis em comunidades isoladas.", correct: true },
                    { text: "As populações de comunidades remotas preferem utilizar combustíveis fósseis por considerarem as energias renováveis menos eficientes.", correct: false },
                    { text: "As energias renováveis exigem conexão com a rede elétrica nacional para funcionarem, o que impossibilita seu uso em locais isolados.", correct: false }
                ]
            },
            {
                id: 5,
                question: "A energia solar fotovoltaica tem se expandido rapidamente no Brasil, com crescimento médio anual superior a 50% nos últimos anos. Esta tecnologia converte diretamente a radiação solar em energia elétrica por meio de painéis constituídos por células fotovoltaicas. Considerando as características dessa fonte de energia, qual alternativa descreve corretamente uma de suas principais vantagens?",
                image: "https://via.placeholder.com/800x400?text=Painéis+Solares+Fotovoltaicos",
                options: [
                    { text: "A energia solar pode ser gerada próximo aos locais de consumo, reduzindo perdas na transmissão e permitindo a eletrificação de áreas remotas não atendidas pela rede elétrica convencional.", correct: true },
                    { text: "Os painéis solares funcionam com a mesma eficiência durante o dia e a noite, garantindo produção constante de energia 24 horas por dia.", correct: false },
                    { text: "A instalação de painéis solares não requer manutenção e tem vida útil ilimitada, tornando-se a opção mais econômica a longo prazo.", correct: false },
                    { text: "A energia solar é uma fonte não renovável, mas seu uso é incentivado devido à sua alta densidade energética.", correct: false }
                ]
            },
            {
                id: 6,
                question: "Os ímãs estão presentes em diversos dispositivos do nosso cotidiano, como motores elétricos, alto-falantes, discos rígidos e até mesmo em fechaduras de portas. As propriedades magnéticas desses materiais são explicadas pelo alinhamento de domínios magnéticos em sua estrutura. Considerando as características dos materiais magnéticos, qual alternativa está correta?",
                image: "",
                options: [
                    { text: "Materiais ferromagnéticos como ferro, níquel e cobalto são fortemente atraídos por ímãs devido ao alinhamento de seus domínios magnéticos quando submetidos a um campo magnético externo.", correct: true },
                    { text: "Todos os metais são igualmente atraídos por ímãs, independentemente de sua composição química ou estrutura atômica.", correct: false },
                    { text: "Ao cortar um ímã ao meio, obtemos duas partes independentes: uma com apenas polo norte e outra com apenas polo sul.", correct: false },
                    { text: "Os polos magnéticos de mesmo nome (norte-norte ou sul-sul) se atraem, enquanto polos de nomes diferentes se repelem.", correct: false }
                ]
            },
            {
                id: 7,
                question: "Em dias secos, é comum sentirmos pequenos choques ao tocarmos em maçanetas metálicas ou outras pessoas. Esse fenômeno está relacionado ao acúmulo de cargas elétricas em nossos corpos, conhecido como eletricidade estática. Considerando os processos de eletrização, qual alternativa explica corretamente como ocorre esse acúmulo de cargas?",
                image: "",
                options: [
                    { text: "O atrito entre diferentes materiais (como solados de sapato e carpete) causa transferência de elétrons entre eles, deixando um dos materiais com excesso de elétrons (carga negativa) e o outro com falta de elétrons (carga positiva).", correct: true },
                    { text: "Nosso corpo naturalmente produz elétrons em excesso que se acumulam na superfície da pele, especialmente em dias secos.", correct: false },
                    { text: "A umidade do ar em dias secos facilita a condução de elétrons para o solo, impedindo o acúmulo de cargas em nosso corpo.", correct: false },
                    { text: "Os choques elétricos são causados pela transferência de prótons entre nosso corpo e objetos metálicos, já que os prótons têm maior mobilidade que os elétrons.", correct: false }
                ]
            },
            {
                id: 8,
                question: "Os raios são descargas elétricas de grande intensidade que ocorrem na atmosfera, principalmente durante tempestades. Estima-se que o Brasil é o país com maior incidência de raios no mundo, com uma média de 70 milhões por ano. Considerando os processos de eletrização envolvidos na formação dos raios, qual alternativa descreve corretamente como ocorre esse fenômeno?",
                image: "https://via.placeholder.com/800x400?text=Raios+e+Tempestades",
                options: [
                    { text: "O atrito entre partículas de gelo, água e granizo no interior das nuvens de tempestade gera separação de cargas, com cargas positivas concentrando-se na parte superior e cargas negativas na parte inferior da nuvem.", correct: true },
                    { text: "Os raios são causados pelo contato directo entre nuvens carregadas e o solo, sem que haja necessidade de diferença de potencial elétrico significativa.", correct: false },
                    { text: "A eletrização por indução é o único processo envolvido na formação dos raios, sendo responsável pela criação de cargas elétricas a partir do nada.", correct: false },
                    { text: "Os raios ocorrem quando o campo magnético terrestre interage com partículas carregadas provenientes do Sol, criando faíscas elétricas na atmosfera.", correct: false }
                ]
            },
            {
                id: 9,
                question: "A Primeira Lei de Ohm, formulada pelo físico alemão Georg Simon Ohm em 1827, estabelece a relação entre tensão elétrica (V), corrente elétrica (I) e resistência elétrica (R) em um circuito. Esta lei é fundamental para o dimensionamento seguro de instalações elétricas. Considerando a aplicação prática dessa lei, qual alternativa apresenta uma situação correta de sua utilização?",
                image: "",
                options: [
                    { text: "Ao projetar a instalação elétrica de um chuveiro, um engenheiro utiliza a Lei de Ohm (I = V/R) para calcular a corrente elétrica que circulará pelo circuito e selecionar a espessura adequada dos fios, evitando superaquecimento e riscos de incêndio.", correct: true },
                    { text: "A Lei de Ohm é utilizada para determinar a quantidade de carga elétrica que uma bateria pode armazenar, independentemente da tensão e resistência do circuito.", correct: false },
                    { text: "Segundo a Lei de Ohm, a resistência elétrica de um material diminui à medida que sua temperatura aumenta, explicando porque os fios elétricos ficam mais condutores quando aquecidos.", correct: false },
                    { text: "A Lei de Ohm estabelece que a tensão elétrica em um circuito é inversamente proporcional à corrente, o que significa que quanto maior a tensão, menor será a corrente para uma mesma resistência.", correct: false }
                ]
            },
            {
                id: 10,
                question: "No final do século XIX, ocorreu a 'Guerra das Correntes' entre Thomas Edison, que defendia a corrente contínua (CC), e Nikola Tesla, que promovia a corrente alternada (CA). A corrente alternada prevaleceu como padrão para distribuição de energia elétrica em larga escala. Considerando as características desses dois tipos de corrente, qual alternativa apresenta corretamente uma vantagem da corrente alternada sobre a contínua para sistemas de distribuição?",
                image: "https://via.placeholder.com/800x400?text=Corrente+Alternada+e+Contínua",
                options: [
                    { text: "A corrente alternada permite facilmente a transformação de tensão usando transformadores, possibilitando a transmissão em alta tensão (com menores perdas) e depois a redução para tensões seguras de utilização.", correct: true },
                    { text: "A corrente alternada é mais eficiente para ser armazenada em baterias, o que facilita o fornecimento contínuo de energia mesmo durante interrupções na geração.", correct: false },
                    { text: "A corrente alternada não sofre perdas durante a transmissão em longas distâncias, mantendo a mesma tensão do ponto de geração até o consumo.", correct: false },
                    { text: "A corrente alternada é mais segura para os usuários, pois causa menos danos em caso de choque elétrico comparada à corrente contínua de mesma tensão.", correct: false }
                ]
            }
        ];

        /* ============================================================
           MAPEAMENTO DAS RESPOSTAS CORRETAS
           ============================================================ */
        const correctAnswersMap = {};
        questions.forEach(q => {
            q.options.forEach((opt, idx) => {
                if (opt.correct) correctAnswersMap[`q${q.id}`] = String.fromCharCode(65 + idx);
            });
        });

        /* ============================================================
           EXIBIÇÃO DE MENSAGENS
           ============================================================ */
        function showResult(msg, type) {
            const el = document.getElementById("resultMessage");
            el.innerHTML = msg;
            el.className = "result " + type;
            el.style.display = "block";
        }
        
        function hideResult() {
            document.getElementById("resultMessage").style.display = "none";
        }

        /* ============================================================
           ENVIO PARA O APPS SCRIPT (CORRIGIDO)
           ============================================================ */
        async function sendToGoogle(dataObj) {
            try {
                // Removendo o cabeçalho 'Content-Type: application/json'
                // O Google Apps Script lida melhor com o tipo de conteúdo padrão (text/plain)
                // quando o JSON é enviado no corpo, e a correção de CORS no Apps Script
                // deve resolver o problema de "Failed to fetch".
                const response = await fetch("https://script.google.com/macros/s/AKfycbx7Nnm9OrWIVGCtBda0-VI5ukgep2iee5ZTKGl923PpV2ACnY_jGccFR9iX1s0Yy-w/exec", {
                    method: "POST",
                    // Removido: headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(dataObj)
                });

                // Verifica se a resposta foi bem-sucedida (status 200-299)
                if (!response.ok) {
                    throw new Error(`Erro HTTP: ${response.status} ${response.statusText}`);
                }

                // Tenta ler a resposta como JSON
                const json = await response.json();

                if (json.status === "success") {
                    showResult("<strong>Sucesso!</strong> Dados enviados e registrados.", "success");
                    document.getElementById("submitBtn").disabled = true;
                } else {
                    showResult(
                        "<strong>Erro no servidor:</strong> " + (json.message || "Resposta inesperada do Apps Script."),
                        "error"
                    );
                }
            } catch (e) {
                // Captura erros de rede (Failed to fetch) e erros de processamento
                showResult(
                    "<strong>Erro de Conexão:</strong> " + e.message + ". Verifique se o Apps Script está publicado corretamente (como 'Qualquer pessoa').",
                    "error"
                );
            }
        }

        /* ============================================================
           RENDERIZAÇÃO DE ALUNOS + QUESTÕES
           ============================================================ */

        document.addEventListener("DOMContentLoaded", () => {
            const select = document.getElementById("studentName");
            const num = document.getElementById("studentNumber");
            const grade = document.getElementById("studentGrade");
            const container = document.getElementById("questionsContainer");
            const dateField = document.getElementById("currentDate");
            
            // Preencher a data atual
            const today = new Date();
            dateField.value = today.toLocaleDateString('pt-BR');

            // Preencher alunos
            Object.keys(students).forEach(turma => {
                const group = document.createElement("optgroup");
                group.label = turma;

                students[turma].forEach(s => {
                    const opt = document.createElement("option");
                    // O valor deve ser: Nº|Série|Nome
                    opt.value = `${s.number}|${turma}|${s.name}`;
                    opt.textContent = s.name;
                    group.appendChild(opt);
                });

                select.appendChild(group);
            });

            // Preencher questões
            questions.forEach(q => {
                const block = document.createElement("div");
                block.className = "question-container";
                block.id = "q" + q.id;

                block.innerHTML = `
                    <p class="question"><strong>${q.id}.</strong> ${q.question}</p>
                    ${q.image ? `<img src="${q.image}" class="question-image">` : ""}
                    <div class="options"></div>
                `;

                const optBox = block.querySelector(".options");

                q.options.forEach((opt, idx) => {
                    const letter = String.fromCharCode(65 + idx);
                    const div = document.createElement("div");
                    div.className = "option";
                    div.dataset.question = q.id;
                    div.dataset.letter = letter;
                    div.textContent = opt.text; // Removido o <strong> da letra

                    div.onclick = () => {
                        optBox.querySelectorAll(".option").forEach(o => o.classList.remove("selected"));
                        div.classList.add("selected");
                        hideResult();
                    };

                    optBox.appendChild(div);
                });

                container.appendChild(block);
            });

            select.onchange = () => {
                if (!select.value) {
                    num.value = "";
                    grade.value = "";
                    return;
                }
                // O valor é: Nº|Série|Nome. Precisamos do Nº e da Série.
                const [n, g] = select.value.split("|");
                num.value = n;
                grade.value = g;
                hideResult();
            };
            
            // Botão limpar respostas
            document.getElementById("clearBtn").onclick = () => {
                document.querySelectorAll(".option.selected").forEach(opt => {
                    opt.classList.remove("selected");
                });
                hideResult();
            };
        });

        /* ============================================================
           ENVIO FINAL
           ============================================================ */

        document.getElementById("submitBtn").onclick = async () => {
            hideResult();

            const select = document.getElementById("studentName");
            if (!select.value) {
                showResult("Selecione seu nome.", "error");
                return;
            }

            // O valor é: Nº|Série|Nome
            const [studentNumber, studentGrade, studentName] = select.value.split("|");
            const data = { studentName, studentNumber, studentGrade };

            let correct = 0;
            let allAnswered = true;
            for (let q of questions) {
                const selected = document.querySelector(`#q${q.id} .option.selected`);
                if (!selected) {
                    allAnswered = false;
                    break;
                }
                const letter = selected.dataset.letter;
                data[`q${q.id}`] = letter;

                if (letter === correctAnswersMap[`q${q.id}`]) correct++;
            }

            if (!allAnswered) {
                showResult("Responda todas as questões.", "error");
                return;
            }

            data.finalScore = correct;

            showResult(`Calculando nota... você acertou ${correct}/${questions.length}. Enviando dados...`, "success");

            await sendToGoogle(data);
        };
    </script>
</body>
</html>



