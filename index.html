<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atividade de Ciências - Recuperação 8º Ano</title>
    <style>
        /* Reset e configurações gerais */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        body {
            background-color: #d0d0d0;
            padding: 20px;
            min-height: 100vh;
            background-image: linear-gradient(145deg, #c0c0c0, #e0e0e0);
        }
        
        /* Container principal */
        .container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background-color: #d0d0d0;
            z-index: 1;
            border-radius: 20px;
            box-shadow: inset 5px 5px 10px #b3b3b3, 
                       inset -5px -5px 10px #ededed;
        }
        
        /* Cabeçalho */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(145deg, #e6f2ff, #cce5ff);
            border-radius: 12px;
            box-shadow: 8px 8px 16px #b3b3b3, 
                       -8px -8px 16px #ffffff;
            position: relative;
            z-index: 2;
            border: 1px solid #b8d4f0;
        }
        
        .school-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #004085;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        /* Informações do aluno - Layout responsivo */
        .student-info {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
        }
        
        @media (max-width: 768px) {
            .student-info {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
        
        .info-group {
            display: flex;
            align-items: center;
        }
        
        .name-group {
            grid-column: 1 / 2;
        }
        
        @media (max-width: 768px) {
            .name-group {
                grid-column: 1 / 2;
            }
        }
        
        .info-label {
            margin-right: 5px;
            font-weight: bold;
            color: #004085;
            white-space: nowrap;
        }
        
        .info-field {
            padding: 8px;
            border: 1px solid #a0c4e0;
            border-radius: 4px;
            background-color: #f8fbff;
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.1);
            text-align: center;
            width: 100%;
        }
        
        .activity-title {
            font-size: 20px;
            font-weight: bold;
            margin: 20px 0;
            text-align: center;
            color: #004085;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        /* Questões */
        .question-container {
            padding: 25px;
            margin-bottom: 30px;
            background: linear-gradient(145deg, #e6f2ff, #cce5ff);
            border-radius: 12px;
            box-shadow: 8px 8px 16px #b3b3b3, 
                       -8px -8px 16px #ffffff;
            position: relative;
            z-index: 2;
            border: 1px solid #b8d4f0;
        }
        
        .question {
            margin-bottom: 15px;
            font-weight: bold;
            color: #004085;
            line-height: 1.4;
        }
        
        .question-image {
            max-width: 100%;
            height: auto;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 4px 4px 8px rgba(0,0,0,0.2);
            border: 1px solid #a0c4e0;
            display: block;
        }
        
        .options {
            margin-top: 15px;
        }
        
        .option {
            margin-bottom: 10px;
            padding: 12px;
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            border-radius: 8px;
            border: 1px solid #d0d0d0;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 4px 4px 8px rgba(0,0,0,0.1),
                       -4px -4px 8px rgba(255,255,255,0.7);
            display: flex;
            align-items: flex-start;
        }
        
        .option:hover {
            background: linear-gradient(145deg, #f5f5f5, #e8e8e8);
            transform: translateY(-2px);
            box-shadow: 6px 6px 12px rgba(0,0,0,0.15),
                       -6px -6px 12px rgba(255,255,255,0.8);
        }
        
        .option.selected {
            background: linear-gradient(145deg, #155724, #0f4019);
            border-color: #0f4019;
            color: white;
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.3),
                        4px 4px 8px rgba(0,0,0,0.1);
        }
        
        .option::before {
            content: attr(data-letter) ".";
            font-weight: bold;
            margin-right: 8px;
            flex-shrink: 0;
        }
        
        /* Botões */
        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            position: relative;
            z-index: 2;
            gap: 15px;
        }
        
        @media (max-width: 480px) {
            .buttons {
                flex-direction: column;
            }
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 6px 6px 12px rgba(0,0,0,0.2),
                       -6px -6px 12px rgba(255,255,255,0.7);
            flex: 1;
        }

        button:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        #submitBtn {
            background: linear-gradient(145deg, #007bff, #0056b3);
            color: white;
        }
        
        #submitBtn:hover:not(:disabled) {
            background: linear-gradient(145deg, #0056b3, #004085);
            transform: translateY(-2px);
            box-shadow: 8px 8px 16px rgba(0,0,0,0.25),
                       -8px -8px 16px rgba(255,255,255,0.7);
        }
        
        #submitBtn:active:not(:disabled) {
            transform: translateY(1px);
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        #clearBtn {
            background: linear-gradient(145deg, #6c757d, #545b62);
            color: white;
        }
        
        #clearBtn:hover {
            background: linear-gradient(145deg, #545b62, #3d4348);
            transform: translateY(-2px);
            box-shadow: 8px 8px 16px rgba(0,0,0,0.25),
                       -8px -8px 16px rgba(255,255,255,0.7);
        }
        
        #clearBtn:active {
            transform: translateY(1px);
            box-shadow: inset 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        /* Resultado */
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
            box-shadow: 4px 4px 8px rgba(0,0,0,0.1);
            position: relative;
            z-index: 2;
            text-align: center;
        }
        
        .success {
            background: linear-gradient(145deg, #d4edda, #c3e6cb);
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .error {
            background: linear-gradient(145deg, #f8d7da, #f5c6cb);
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="school-name">E.E. PROFª WANDA MASCAGNI DE SÁ</div>
            <div class="student-info">
                <div class="info-group name-group">
                    <span class="info-label">NOME:</span>
                    <select id="studentName" class="info-field">
                        <option value="">Selecione seu nome</option>
                        <!-- Opções serão preenchidas via JavaScript -->
                    </select>
                </div>
                <div class="info-group">
                    <span class="info-label">Nº:</span>
                    <input type="text" id="studentNumber" class="info-field" readonly>
                </div>
                <div class="info-group">
                    <span class="info-label">SÉRIE:</span>
                    <input type="text" id="studentGrade" class="info-field" readonly>
                </div>
                <div class="info-group">
                    <span class="info-label">DATA:</span>
                    <input type="text" id="currentDate" class="info-field" value="" readonly>
                </div>
            </div>
            <div class="activity-title">ATIVIDADE DE CIÊNCIAS (RECUPERAÇÃO 8º ANO)</div>
        </div>
        
        <div id="questionsContainer">
            <!-- As questões serão inseridas aqui via JavaScript -->
        </div>
        
        <div class="buttons">
            <button id="submitBtn">Enviar Respostas</button>
            <button id="clearBtn">Limpar Respostas</button>
        </div>
        
        <div id="resultMessage" class="result"></div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            /* ============================================================
               CONFIGURAÇÕES GERAIS
               ============================================================ */
            // ATENÇÃO: SUBSTITUA ESTA URL PELA URL DE IMPLANTAÇÃO DO SEU APPS SCRIPT
            const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx0w4uU8Rn-LLfKT3zsvAA-4n9W2RNoEnG9R32XheqsJnOraALAwfIxPNtbqdHyj44/exec";

            /* ============================================================
               LISTA COMPLETA DE ALUNOS
               ============================================================ */
            const students = {
                "8º Ano A": [
                    { number: "2", name: "ANA BEATRIZ RODRIGUES OLIVEIRA" }, { number: "3", name: "ANA CLARA SOUSA DA COSTA" }, { number: "4", name: "ANA VICTORIA RAGACINI DE OLIVEIRA" }, { number: "5", name: "ARTHUR DAVI DE SOUZA FERNANDES" }, { number: "6", name: "EDUARDA ALVES DE SOUZA" }, { number: "7", name: "EMANUEL ALVES OLIVEIRA" }, { number: "8", name: "ESTHER CRISTINE SILVA RIBEIRO" }, { number: "9", name: "EVELLYN YASMIN TAVARES SILVA" }, { number: "10", name: "FELIPE DE SOUZA RODRIGUES" }, { number: "11", name: "FERNANDA POLACHINI MAYER GOMES MARQUES" }, { number: "12", name: "GEOVANNA VITORIA ROCHA ABDALA" }, { number: "15", name: "GUSTAVO AUGUSTO TOMBOLO REIS" }, { number: "17", name: "IGOR MARTINS PEREIRA" }, { number: "18", name: "IZABELLY VITORIA DE CARVALHO RODRIGUES SETH" }, { number: "21", "name": "KAROLAYNE DOS SANTOS BISSORNIA" }, { number: "22", name: "KAUANNY APARECIDA MALAQUIAS LIMA" }, { number: "23", name: "KÉTHILY NAYARA DA SILVA" }, { number: "25", name: "LAVINIA PEREIRA DE SOUZA" }, { number: "26", name: "LIVIA PEREIRA DE SOUZA" }, { number: "27", name: "LOHRAN ROMUALDO MENDES DA SILVA" }, { number: "28", name: "LUIS MIGUEL GONCALVES DA SILVA" }, { number: "29", name: "MARCELA ROBERTO DE OLIVEIRA" }, { number: "31", name: "MATHEUS TURCHETTO" }, { number: "32", name: "OMRAN RASEKH" }, { number: "33", name: "PRISCILLA VITORIA MENDES DE OLIVEIRA" }, { number: "36", name: "SARAH VITORIA ALVES OLIVEIRA" }, { number: "37", name: "YURI GABRIEL DE MORAES PONGOLINO" }, { number: "38", name: "ZAYN AL ABIDIN RASULI" }, { number: "39", name: "ARTHUR COHEN BARRETO" }, { number: "40", name: "ISABELLA DOS SANTOS SALDANHA" }, { number: "41", name: "MIGUEL MARTINS DE ASSIS" }, { number: "42", name: "ALICE CARVALHO" }, { number: "43", name: "AMANDA PASSOS DE ALMEIDA" }, { number: "44", name: "ANA JULIA MENEZES DA SILVA" }, { number: "45", name: "HENRIQUE ROCHA CARVALHAL" }
                ],
                "8º Ano B": [
                    { number: "2", name: "ANA CLARA GONCALVES TORRES LOYOLA" }, { number: "3", name: "ANNA BEATRIZ SANTIAGO DA SILVA" }, { number: "6", name: "ELIAS SILVA DE LIMA" }, { number: "7", name: "EVERTON HENRIQUE CARMO RODRIGUES" }, { number: "9", name: "GABRIELA VITORIA SEVERA LINS" }, { number: "12", name: "JULIO CESAR ALVES DOS SANTOS" }, { number: "14", name: "LUAN VENITES BALBINO" }, { number: "17", name: "MARIA EDUARDA FELIX DA SILVA" }, { number: "18", name: "MONIQUE RIJO COSTA" }, { number: "19", name: "MUNIQUE CRISTINA LUCAS" }, { number: "20", name: "NICOLAS PENTEADO" }, { number: "23", name: "PAULO CELSO DA COSTA JUNIOR" }, { number: "24", name: "PEDRO HENRIQUE CARLOS LIMA" }, { number: "25", name: "PEDRO HENRIQUE MORAIS AMORIM" }, { number: "27", name: "PIETRO RODRIGUES MIRANDA" }, { number: "28", name: "RAPHAELLY APARECIDA MARINHO DE OLIVEIRA" }, { number: "29", name: "RENAN LEANDRO RODRIGUES VICENTE" }, { number: "33", name: "WENDELL RAFAEL DE JESUS LESSA" }, { number: "34", name: "WILHAN KENJI ANTONIO" }, { number: "40", name: "JENNYFER VITORIA BASILIO GOMES" }, { number: "41", name: "THAYNA SEABRA DE OLIVEIRA DO NASCIMENTO" }, { number: "46", name: "SOPHIA MENEZES DE ARAUJO" }, { number: "47", name: "VITORIA MENEZES BRANDAO" }, { number: "49", name: "LORENA ALEXANDRE SANTOS DA SILVA" }, { number: "50", name: "MANUELLA DE MORAES SOUZA" }, { number: "51", name: "VITORIA JOLIE RODRIGUES RAPOSO" }, { number: "52", name: "RAQUEL BARGAS TAVARES DOS SANTOS" }, { number: "53", name: "RODOLFO RAFAEL GOLZENLEUCHTER MORENO JUNIOR" }, { number: "54", name: "ANTONIO CARLOS CAMPOS NETO" }
                ]
            };

            /* ============================================================
               QUESTÕES DO TESTE
               ============================================================ */
            const questions = [
                { id: 1, question: "Durante uma aula de Ciências, os alunos realizaram um experimento para identificar diferentes formas de energia. Eles observaram que ao ligar um ventilador, a energia elétrica era convertida em energia mecânica (movimento das pás) e energia sonora (ruído do motor). Além disso, após algum tempo de funcionamento, notaram que o motor do ventilador estava aquecido. Considerando os diferentes tipos de energia estudados, qual alternativa descreve corretamente as transformações de energia que ocorrem nesse aparelho?", image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy9Mwn8aPWz42wdeXslRn3POEYYz3k1sq0hGvlo_mFDJCRIHRylP6xk4d3k3xU88EY7yTW1wCJ5FZFJYIdQRimab1fJ9H936R4N_c6uRpgguSsOhmbNPOXi-_X4jQggZt-WUgTFxvmeFI3ulln_moyvRa8ZzyQDhVqfedbqJsfFZnLUylF-bOjCi38FUx4/s450/ChatGPT%20Image%2021%20de%20nov.%20de%202025,%2019_28_02.png", options: [{ text: "A energia elétrica é transformada apenas em energia mecânica, sendo o ruído e o calor considerados perdas energéticas indesejadas.", correct: false }, { text: "A energia elétrica se transforma em energia mecânica, sonora e térmica, demonstrando o princípio da conservação da energia, donde a energia total se mantém, apenas mudando de forma.", correct: true }, { text: "O calor gerado pelo motor representa uma criação de energia térmica que não existia anteriormente no sistema, contrariando o princípio de conservação.", correct: false }, { text: "A energia sonora produzida pelo ventilador é uma forma primária de energia que não deriva da energia elétrica fornecida ao aparelho.", correct: false }] },
                { id: 2, question: "O Brasil possui uma matriz energética diversificada, com significativa participação de fontes renováveis. Em 2023, cerca de 48% da energia consumida no país veio de fontes renováveis, enquanto a média mundial é de aproximadamente 14%. Considerando as características das fontes de energia renováveis e não renováveis, qual alternativa apresenta corretamente uma vantagem das fontes renováveis em relação às não renováveis?", image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEik6earnY-dVxl6vIuWRF4cXZn_iWf44RHrznBwvjJUmuP_uB6FW0QJ-fy9n04j3WUVlKhWFI-uJNarFJ33Za5CtM1DKCsCximzI64Uthpetk7o1XpBY0zcdW6u-54g22ZnzXqEyhkLF8RL1dCpCfb7urpLG_C1hwur0TSbbGkj86yT_MG3k6oveRGAg4Vu/s450/Capturar.JPG", options: [{ text: "As fontes renováveis apresentam custos de instalação sempre inferiores aos das fontes não renováveis, tornando-as mais acessíveis economicamente.", correct: false }, { text: "As fontes renováveis são inesgotáveis em escala humana e causam menor impacto ambiental, contribuindo para a sustentabilidade e reduzindo as emissões de gases de efeito estufa.", correct: true }, { text: "As fontes renováveis não dependem de condições climáticas para seu funcionamento, garantindo produção constante e previsível de energia.", correct: false }, { text: "As fontes renováveis não exigem grandes áreas para instalação, sendo mais adequadas para regiões urbanas densamente povoadas.", correct: false }] },
                { id: 3, question: "Em uma montanha-russa, os carrinhos são puxados até o ponto mais alto por um mecanismo motorizado. Ao serem soltos, descem rapidamente, subindo novamente em seguida, sem necessidade de motor durante a maior parte do percurso. Considerando o princípio da conservação da energia, qual alternativa explica corretamente o funcionamento da montanha-russa?", image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiYAJkqusBlaY1Tkjt5op7135woDvNe7laN4qJx52Jh5UNVk7eoJOnIEwS6NvWLQPa7xd4Yb9Z5m39dPegpQabyEn5KEHBhbURja1TQIY305KlvaPlnAiz2tIx4asQvkd6HGQDtmHxET153h4yH_7jVC8rhG2gtr9O6s7nXw_HjaQQR3npi7yPR1IIR3WMo/s450/Capturar.JPG", options: [{ text: "A energia potencial gravitacional acumulada no ponto mais alto é convertida em energia cinética durante a descida, e parte dessa energia cinética é novamente convertida em energia potencial nas subidas subsequentes.", correct: true }, { text: "A energia cinética permanece constante durante todo o percurso, pois a velocidade dos carrinhos não varia significativamente.", correct: false }, { text: "A energia total do sistema aumenta durante as descidas e diminui durante as subidas, demonstrando que a energia pode ser criada e destruída.", correct: false }, { text: "A energia potencial é máxima nos pontos mais baixos do percurso e mínima nos pontos mais altos, permitindo o movimento contínuo dos carrinhos.", correct: false }] },
                { id: 4, question: "O Objetivo de Desenvolvimento Sustentável (ODS) 7 da ONU visa 'garantir o acesso a fontes de energia acessíveis, confiáveis, sustentáveis e modernas para todos' até 2030. No Brasil, aproximadamente 2 milhões de pessoas ainda não têm acesso à energia elétrica, especialmente em comunidades remotas. Considerando esse contexto, qual alternativa apresenta corretamente um desafio para a implementação de energias renováveis nessas regiões?", image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgbcQR4REmb-snjFeTenlDo_JnvwWruHmjRhdFOqxIM-Ck-WPL0J1KMfCyGJw38N3x_ul_7pD3s3ftX-vc0fuN7Kq0l9qaKOIHas85qd7iv4llziEvk7ZPaMrrhEliEHlNT7TsssVCnT9pv5UsG_SfnKEqiwj4IAVD7sIGvJTVQozJ2z1Zv_tzHk7B8K2Kf/s398/Capturar.JPG", options: [{ text: "As energias renováveis são tecnicamente inviáveis em áreas remotas devido à falta de vento ou radiação solar nessas regiões.", correct: false }, { text: "O alto custo inicial de instalação, a falta de mão de obra especializada e as dificuldades de acesso a algumas localidades são obstáculos para a implementação de energias renováveis em comunidades isoladas.", correct: true }, { text: "As populações de comunidades remotas preferem utilizar combustíveis fósseis por considerarem as energias renováveis menos eficientes.", correct: false }, { text: "As energias renováveis exigem conexão com a rede elétrica nacional para funcionarem, o que impossibilita seu uso em locais isolados.", correct: false }] },
                { id: 5, question: "A energia solar fotovoltaica tem se expandido rapidamente no Brasil, com crescimento médio anual superior a 50% nos últimos anos. Esta tecnologia converte diretamente a radiação solar em energia elétrica por meio de painéis constituídos por células fotovoltaicas. Considerando as características dessa fonte de energia, qual alternativa descreve corretamente uma de suas principais vantagens?", image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjBDi1ZWIOdVnTDManFFpMrQz0FK7Uh4tqi3Ke_gfAvPMhPFw4K0u4WFapjf7YSkQH8u6K4cXMpTDRyl-XGHrFkSKNr5l8FdWPvALX-NneRQgBlS1E62NdN8SlEpd2U5RYTmGj78J28LjMk0e7AsyGnRW5G48kn3Slt_YIzDmqgtlNQ8bhZihqNDNZKRR-V/s450/Capturar.JPG", options: [{ text: "A energia solar pode ser gerada próximo aos locais de consumo, reduzindo perdas na transmissão e permitindo a eletrificação de áreas remotas não atendidas pela rede elétrica convencional.", correct: true }, { text: "Os painéis solares funcionam com a mesma eficiência durante o dia e a noite, garantindo produção constante de energia 24 horas por dia.", correct: false }, { text: "A instalação de painéis solares não requer manutenção e tem vida útil ilimitada, tornando-se a opção mais econômica a longo prazo.", correct: false }, { text: "A energia solar é uma fonte não renovável, mas seu uso é incentivado devido à sua alta densidade energética.", correct: false }] },
                { id: 6, question: "Os ímãs estão presentes em diversos dispositivos do nosso cotidiano, como motores elétricos, alto-falantes, discos rígidos e até mesmo em fechaduras de portas. As propriedades magnéticas desses materiais são explicadas pelo alinhamento de domínios magnéticos em sua estrutura. Considerando as características dos materiais magnéticos, qual alternativa está correta?", image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjTpBJaDAOrnOGQK_EPFQYWGGcrB99TjLlzBziC0MaCUYClJQxBJTEY3koFb37mo5KFhMrJKSzBA84J8kDt1omeN45cy8Y2SbWYhlBiVzrwfekXCbreTsPd8ujD-jo1s1M4Pg3E1TPrT0Jz7S6HhMR-yT4LlNrPQqmYYguPQtcEyKA7Nv8MUYK63ZJlGGVd/s450/ChatGPT%20Image%2021%20de%20nov.%20de%202025,%2020_06_31.png", options: [{ text: "Materiais ferromagnéticos como ferro, níquel e cobalto são fortemente atraídos por ímãs devido ao alinhamento de seus domínios magnéticos quando submetidos a um campo magnético externo.", correct: true }, { text: "Todos os metais são igualmente atraídos por ímãs, independentemente de sua composição química ou estrutura atômica.", correct: false }, { text: "Ao cortar um ímã ao meio, obtemos duas partes independentes: uma com apenas polo norte e outra com apenas polo sul.", correct: false }, { text: "Os polos magnéticos de mesmo nome (norte-norte ou sul-sul) se atraem, enquanto polos de nomes diferentes se repelem.", correct: false }] },
                { id: 7, question: "Em dias secos, é comum sentirmos pequenos choques ao tocarmos em maçanetas metálicas ou outras pessoas. Esse fenômeno está relacionado ao acúmulo de cargas elétricas em nossos corpos, conhecido como eletricidade estática. Considerando os processos de eletrização, qual alternativa explica corretamente como ocorre esse acúmulo de cargas?", image: "", options: [{ text: "O atrito entre diferentes materiais (como solados de sapato e carpete) causa transferência de elétrons entre eles, deixando um dos materiais com excesso de elétrons (carga negativa) e o outro com falta de elétrons (carga positiva).", correct: true }, { text: "Nosso corpo naturalmente produz elétrons em excesso que se acumulam na superfície da pele, especialmente em dias secos.", correct: false }, { text: "A umidade do ar em dias secos facilita a condução de elétrons para o solo, impedindo o acúmulo de cargas em nosso corpo.", correct: false }, { text: "Os choques elétricos são causados pela transferência de prótons entre nosso corpo e objetos metálicos, já que os prótons têm maior mobilidade que os elétrons.", correct: false }] },
                { id: 8, question: "Os raios são descargas elétricas de grande intensidade que ocorrem na atmosfera, principalmente durante tempestades. Estima-se que o Brasil é o país com maior incidência de raios no mundo, com uma média de 70 milhões por ano. Considerando os processos de eletrização envolvidos na formação dos raios, qual alternativa descreve corretamente como ocorre esse fenômeno?", image: "https://via.placeholder.com/800x400?text=Raios+e+Tempestades", options: [{ text: "O atrito entre partículas de gelo, água e granizo no interior das nuvens de tempestade gera separação de cargas, com cargas positivas concentrando-se na parte superior e cargas negativas na inferior da nuvem.", correct: true }, { text: "Os raios são causados pelo contato directo entre nuvens carregadas e o solo, sem que haja necessidade de diferença de potencial elétrico significativa.", correct: false }, { text: "A eletrização por indução é o principal mecanismo, onde a nuvem atua como um corpo neutro que é aproximado de um corpo carregado (o solo).", correct: false }, { text: "O raio é uma descarga de prótons que se movem da nuvem para o solo, buscando o equilíbrio de cargas.", correct: false }] },
                { id: 9, question: "O eletromagnetismo é o ramo da física que estuda a relação entre eletricidade e magnetismo. Um dos princípios fundamentais é que um campo magnético pode ser gerado por uma corrente elétrica. Qual dispositivo utiliza esse princípio para converter energia elétrica em energia mecânica (movimento)?", image: "https://via.placeholder.com/800x400?text=Eletromagnetismo", options: [{ text: "Gerador elétrico", correct: false }, { text: "Transformador", correct: false }, { text: "Motor elétrico", correct: true }, { text: "Pilha galvânica", correct: false }] },
                { id: 10, question: "A Lei de Ohm é fundamental para o estudo de circuitos elétricos e estabelece a relação entre tensão (U), corrente (I) e resistência (R). Qual é a fórmula matemática que representa a Lei de Ohm?", image: "https://via.placeholder.com/800x400?text=Lei+de+Ohm", options: [{ text: "P = U * I (Potência é igual a Tensão vezes Corrente)", correct: false }, { text: "U = R / I (Tensão é igual a Resistência dividida pela Corrente)", correct: false }, { text: "U = R * I (Tensão é igual a Resistência vezes Corrente)", correct: true }, { text: "I = U * R (Corrente é igual a Tensão vezes Resistência)", correct: false }] }
            ];

            /* ============================================================
               FUNÇÕES DE INICIALIZAÇÃO E RENDERIZAÇÃO
               ============================================================ */

            const studentSelect = document.getElementById('studentName');
            const studentNumberInput = document.getElementById('studentNumber');
            const studentGradeInput = document.getElementById('studentGrade');
            const currentDateInput = document.getElementById('currentDate');
            const questionsContainer = document.getElementById('questionsContainer');
            const submitBtn = document.getElementById('submitBtn');
            const clearBtn = document.getElementById('clearBtn');
            const resultMessage = document.getElementById('resultMessage');

            // 1. Preenche o campo de data
            const today = new Date();
            const formattedDate = today.toLocaleDateString('pt-BR');
            currentDateInput.value = formattedDate;

            // 2. Preenche o dropdown de alunos
            function populateStudents() {
                // Adiciona as opções de série como <optgroup>
                for (const grade in students) {
                    const optgroup = document.createElement('optgroup');
                    optgroup.label = grade;
                    
                    // Adiciona os alunos dentro de cada <optgroup>
                    students[grade].forEach(student => {
                        const option = document.createElement('option');
                        option.value = `${student.name}|${student.number}|${grade}`;
                        option.textContent = student.name;
                        optgroup.appendChild(option);
                    });
                    studentSelect.appendChild(optgroup);
                }
            }

            // 3. Renderiza as questões
            function renderQuestions() {
                questionsContainer.innerHTML = '';
                const letters = ['A', 'B', 'C', 'D'];

                questions.forEach((q, qIndex) => {
                    const qElement = document.createElement('div');
                    qElement.className = 'question-container';
                    qElement.setAttribute('data-question-id', q.id);
                    
                    let html = `<div class="question">Q${q.id}. ${q.question}</div>`;
                    
                    if (q.image && q.image.trim() !== "" && q.image.indexOf("via.placeholder") === -1) {
                        html += `<img src="${q.image}" alt="Imagem da Questão ${q.id}" class="question-image">`;
                    }

                    html += `<div class="options" data-question-index="${qIndex}">`;
                    
                    q.options.forEach((opt, oIndex) => {
                        const letter = letters[oIndex];
                        html += `
                            <div class="option" data-letter="${letter}" data-value="${letter}" data-correct="${opt.correct}">
                                ${opt.text}
                            </div>
                        `;
                    });
                    
                    html += `</div>`;
                    qElement.innerHTML = html;
                    questionsContainer.appendChild(qElement);
                });
            }

            // 4. Adiciona listeners de eventos
            function addEventListeners() {
                // Listener para seleção de aluno
                studentSelect.addEventListener('change', (event) => {
                    const selectedValue = event.target.value;
                    if (selectedValue) {
                        const [name, number, grade] = selectedValue.split('|');
                        studentNumberInput.value = number;
                        studentGradeInput.value = grade;
                    } else {
                        studentNumberInput.value = '';
                        studentGradeInput.value = '';
                    }
                    hideMessage();
                });

                // Listener para seleção de opção
                questionsContainer.addEventListener('click', (event) => {
                    const optionElement = event.target.closest('.option');
                    if (optionElement) {
                        const optionsContainer = optionElement.closest('.options');
                        
                        // Remove a seleção de todas as opções desta questão
                        optionsContainer.querySelectorAll('.option').forEach(opt => {
                            opt.classList.remove('selected');
                        });
                        
                        // Adiciona a seleção à opção clicada
                        optionElement.classList.add('selected');
                        hideMessage();
                    }
                });

                // Listener para o botão de envio
                submitBtn.addEventListener('click', handleSubmit);

                // Listener para o botão de limpar
                clearBtn.addEventListener('click', clearResponses);
            }

            /* ============================================================
               FUNÇÕES DE VALIDAÇÃO E ENVIO
               ============================================================ */

            function showMessage(type, message) {
                resultMessage.className = `result ${type}`;
                resultMessage.textContent = message;
                resultMessage.style.display = 'block';
            }

            function hideMessage() {
                resultMessage.style.display = 'none';
            }

            function clearResponses() {
                // Limpa as seleções de resposta
                questionsContainer.querySelectorAll('.option.selected').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Limpa a seleção do aluno
                studentSelect.value = "";
                studentNumberInput.value = "";
                studentGradeInput.value = "";
                
                hideMessage();
                submitBtn.disabled = false;
                showMessage('info', 'Respostas e seleção de aluno limpas. Você pode recomeçar.');
            }

            function validateForm(answers) {
                if (!studentSelect.value) {
                    showMessage('error', 'Por favor, selecione seu nome na lista antes de enviar.');
                    return false;
                }

                if (answers.length !== questions.length) {
                    showMessage('error', `Você respondeu ${answers.length} de ${questions.length} questões. Por favor, responda todas as questões.`);
                    return false;
                }
                return true;
            }

            async function handleSubmit() {
                submitBtn.disabled = true;
                showMessage('info', 'Enviando respostas, por favor aguarde...');

                const [name, number, grade] = studentSelect.value.split('|');
                
                // 1. Coleta as respostas
                const answers = questions.map((q, index) => {
                    const selectedOption = questionsContainer.querySelector(`.question-container[data-question-id="${q.id}"] .option.selected`);
                    
                    if (selectedOption) {
                        const selectedLetter = selectedOption.getAttribute('data-value');
                        const isCorrect = selectedOption.getAttribute('data-correct') === 'true';
                        
                        return {
                            questionId: q.id,
                            answer: selectedLetter,
                            isCorrect: isCorrect
                        };
                    }
                    return null; // Retorna null se a questão não foi respondida
                }).filter(a => a !== null); // Filtra as questões não respondidas

                // 2. Validação
                if (!validateForm(answers)) {
                    submitBtn.disabled = false;
                    return;
                }

                // 3. Prepara os dados para o Apps Script
                const score = answers.filter(a => a.isCorrect).length;
                const totalQuestions = questions.length;
                const percentage = ((score / totalQuestions) * 100).toFixed(2);

                const dataObj = {
                    timestamp: new Date().toLocaleString('pt-BR'),
                    name: name,
                    number: number,
                    grade: grade,
                    score: score,
                    total: totalQuestions,
                    percentage: percentage,
                    answers: answers.map(a => `Q${a.questionId}:${a.answer}`).join('; ')
                };

                // 4. Envia para o Apps Script
                try {
                    // CORREÇÃO CRUCIAL: Removendo o cabeçalho "Content-Type" para evitar o erro "Failed to fetch"
                    const response = await fetch(GOOGLE_SCRIPT_URL, {
                        method: "POST",
                        // headers: { "Content-Type": "application/json" }, // LINHA REMOVIDA/COMENTADA
                        body: JSON.stringify(dataObj)
                    });

                    // O Apps Script retorna um JSON com { result: 'success', message: '...' }
                    const result = await response.json();

                    if (response.ok && result.result === 'success') {
                        showMessage('success', `Respostas enviadas com sucesso! Sua pontuação: ${score}/${totalQuestions} (${percentage}%).`);
                        // Desabilita o botão para evitar reenvio
                        submitBtn.disabled = true; 
                    } else {
                        // Trata erros retornados pelo Apps Script
                        showMessage('error', `Erro ao registrar: ${result.message || 'Resposta inesperada do servidor.'}`);
                        submitBtn.disabled = false;
                    }

                } catch (error) {
                    // Trata erros de rede (como o "Failed to fetch" original)
                    console.error("Erro de Conexão:", error);
                    showMessage('error', `Erro de Conexão: Não foi possível se comunicar com o servidor. Verifique sua conexão e se o Apps Script está publicado corretamente (como 'Qualquer pessoa'). Detalhe: ${error.message}`);
                    submitBtn.disabled = false;
                }
            }

            // Inicia a aplicação
            populateStudents();
            renderQuestions();
            addEventListeners();
        });
    </script>
</body>
</html>




